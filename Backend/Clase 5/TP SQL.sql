CREATE DATABASE clase_5_prog_3;

USE clase_5_prog_3;


CREATE TABLE USUARIO(
	ID int,
	NOMBRE varchar(50),
	APELLIDO varchar(50),
	CLAVE int,
	MAIL varchar(50),
	FECHA_DE_REGISTRO date,
	LOCALIDAD varchar(100)
);

CREATE TABLE PRODUCTO(
	ID int,
	CODIGO_DE_BARRA varchar(8),
	NOMBRE varchar(250),
	TIPO varchar(250),
	STOCK int,
	PRECIO decimal,
	FECHA_DE_CREACION date,
	FECHA_DE_MODIFICACION date
);

CREATE TABLE VENTA(
	ID int,
	ID_PRODUCTO int,
	ID_USUARIO int,
	CANTIDAD int,
	FECHA_DE_VENTA date
);

-----------------------------------------------------------

INSERT INTO PRODUCTO(ID,CODIGO_DE_BARRA, NOMBRE, TIPO, STOCK, PRECIO, FECHA_DE_CREACION, FECHA_DE_MODIFICACION)
VALUES (1001,'77900361', 'Westmacott', 'liquido', 33, 15.87, '2021-2-9', '2020-9-26'),
(1002,'77900362', 'Spirit', 'solido', 45, 69.74, '2020-9-18', '2020-9-26'),
(1003,'77900363', 'Newgrosh', 'polvo', 14, 68.19, '2020-11-29', '2020-9-26'),
(1004,'77900364', 'McNickle', 'polvo', 19, 53.51, '2020-11-28', '2020-9-26'),
(1005,'77900365', 'Hudd', 'solido', 68, 26.56, '2020-12-19', '2020-9-26'),
(1006,'77900366', 'Schrader', 'polvo', 17, 96.54, '2020-2-8', '2020-9-26'),
(1007,'77900367', 'Bachellier', 'solido', 59, 69.17, '2021-1-30', '2020-9-26'),
(1008,'77900368', 'Fleming', 'solido', 38, 66.77, '2020-10-26', '2020-9-26'),
(1009,'77900369', 'Hurry', 'solido', 44, 43.01, '2020-7-4', '2020-9-26'),
(1010,'77900310', 'Krauss', 'polvo', 73, 35.73, '2021-3-3', '2020-9-26');

-----------------------------------------------------------

INSERT INTO USUARIO(ID,NOMBRE,APELLIDO,CLAVE,MAIL,FECHA_DE_REGISTRO,LOCALIDAD)
VALUES(101,'Esteban','Madou',2345,'dkantor0@example.com','2021-1-7','Quilmes'),
(102,'German','Gerram',1234,'ggerram1@hud.gov','2020-5-8','Berazategui'),
(103,'Deloris','Fosis',5678,'bsharpe2@wisc.edu','2020-11-28','Avellaneda'),
(104,'Brok','Neiner',4567,'bblazic3@desdev.cn','2020-12-8','Quilmes'),
(105,'Garrick','Brent',6789,'gbrent4@theguardian.com','2020-12-17','Moron'),
(106,'Bill','Baus',0123,'bhoff5@addthis.com','2020-11-27','Moreno');

-----------------------------------------------------------

INSERT INTO VENTA(ID,ID_PRODUCTO,ID_USUARIO,CANTIDAD,FECHA_DE_VENTA)
VALUES(1,1001,101,2,'2020-7-19'),
(2,1008,102,3,'2020-8-16'),
(3,1007,102,4,'2021-1-24'),
(4,1006,103,5,'2021-1-14'),
(5,1003,104,6,'2021-3-20'),
(6,1005,105,7,'2021-2-22'),
(7,1003,104,6,'2020-12-2'),
(8,1003,106,6,'2020-10-6'),
(9,1002,106,6,'2021-2-4'),
(10,1001,106,1,'2020-5-17');

-----------------------------------------------------------

use clase_7_prog_3;
--1
SELECT * FROM USUARIO ORDER BY APELLIDO;
--2
SELECT * FROM PRODUCTO WHERE TIPO='liquido';
--3
SELECT * FROM VENTA WHERE CANTIDAD>6 AND CANTIDAD <=10;
--4
SELECT SUM(CANTIDAD) FROM VENTA;
--5
SELECT P.ID FROM PRODUCTO P JOIN VENTA V ON P.ID=V.ID_PRODUCTO LIMIT 3;
--6
SELECT U.NOMBRE AS NOMBRE_USUARIO, P.NOMBRE AS NOMBRE_PRODUCTO FROM USUARIO U INNER JOIN  VENTA V ON U.ID = V.ID_USUARIO INNER JOIN PRODUCTO P ON V.ID_PRODUCTO = P.ID;
--7
SELECT  V.CANTIDAD * P.PRECIO AS MONTO FROM VENTA V JOIN PRODUCTO P ON V.ID_PRODUCTO=P.ID;
--8
SELECT SUM(CANTIDAD) FROM VENTA WHERE ID_PRODUCTO=1003 AND ID_USUARIO=104;
--9
SELECT ID_PRODUCTO FROM VENTA V INNER JOIN PRODUCTO P ON V.ID_PRODUCTO=P.ID INNER JOIN USUARIO U ON V.ID_USUARIO = U.ID WHERE U.LOCALIDAD = 'Avellaneda';
--10
SELECT * FROM USUARIO WHERE NOMBRE LIKE '%u%';
--11
SELECT * FROM VENTA WHERE FECHA_DE_VENTA > '2020-05-31' AND FECHA_DE_VENTA < '2021-03-01';
--12
SELECT * FROM USUARIO WHERE FECHA_DE_REGISTRO < '2021-01-01';
--13
INSERT INTO PRODUCTO(CODIGO_DE_BARRA, NOMBRE, TIPO, STOCK, PRECIO, FECHA_DE_CREACION, FECHA_DE_MODIFICACION)
VALUES ('12345678', 'Chocolate', 'solido', 20, 25.35, '2021-2-10', '2020-2-28');
--14
INSERT INTO USUARIO(NOMBRE,APELLIDO,CLAVE,MAIL,FECHA_DE_REGISTRO,LOCALIDAD)
VALUES('Flor','Galeano',1010,'florcis123@flor.com','2022-03-19','Lanus');
--15
update PRODUCTO SET PRECIO=66.60 WHERE TIPO='solido';
--16
update PRODUCTO SET STOCK=0 WHERE STOCK<=20;
--17
DELETE FROM PRODUCTO WHERE ID=1010;
--18
DELETE FROM usuario WHERE usuario.id NOT IN (SELECT ID_USUARIO FROM VENTA);